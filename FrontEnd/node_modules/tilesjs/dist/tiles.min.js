/*! Tiles.js v1.0.0 | http://thinkpixellab.com/tilesjs */
var Tiles={};!function(a){var b=Tiles.Tile=function(b,c){this.id=b,this.top=0,this.left=0,this.width=0,this.height=0,this.$el=a(c||document.createElement("div"))};b.prototype.appendTo=function(a,b,c,d){this.$el.hide().appendTo(a),b?this.$el.delay(c).fadeIn(d):this.$el.show()},b.prototype.remove=function(b,c){b?this.$el.fadeOut({complete:function(){a(this).remove()}}):this.$el.remove()},b.prototype.resize=function(a,b,c,d,e){var f={},g=!1;this.left!==b.x&&(f.left=b.x,this.left=b.x,g=!0),this.top!==b.y&&(f.top=b.y,this.top=b.y,g=!0),this.width!==b.width&&(f.width=b.width,this.width=b.width,g=!0),this.height!==b.height&&(f.height=b.height,this.height=b.height,g=!0);var h=this,i=function(){var a=h.$el[0];h.left!==a.offsetLeft&&h.$el.css("left",h.left),h.top!==a.offsetTop&&h.$el.css("top",h.top),e&&e()};c&&g?this.$el.animate(f,{duration:d,easing:"swing",complete:i}):(g&&this.$el.css(f),setTimeout(i,d))}}(jQuery),function(a){function b(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d}var c=function(a){var b,c,d,e,f,g=[],h=a.length;for(c=0;h>c;c++)for(d=a[c],g[c]=[],b=0,e=d.length;e>b;b++)f=d[b]," "!==f&&g[c].push(f);return g};b.prototype.copy=function(){return new b(this.x,this.y,this.width,this.height)},Tiles.Rectangle=b;var d=function(a){var c,d,e,f,g,h,i,j=[],k=a.length,l=0===k?0:a[0].length;for(a=a.slice(),g=0;k>g;g++)a[g]=a[g].slice();for(g=0;k>g;g++)for(f=0;l>f;f++)if(c=a[g][f],null!=c){if(e=1,d=1,c!==Tiles.Template.SINGLE_CELL){for(;l>e+f&&c===a[g][f+e];)e++;for(;k>d+g&&c===a[g+d][f];)d++}for(i=0;d>i;i++)for(h=0;e>h;h++)a[g+i][f+h]=null;j.push(new b(f,g,e,d))}return j};Tiles.Template=function(a,b,c){this.rects=a,this.numTiles=this.rects.length,this.numRows=c,this.numCols=b},Tiles.Template.prototype.copy=function(){var a,b,c=[];for(b=0,a=this.rects.length;a>b;b++)c.push(this.rects[b].copy());return new Tiles.Template(c,this.numCols,this.numRows)},Tiles.Template.prototype.append=function(a){if(this.numCols!==a.numCols)throw"Appended templates must have the same number of columns";var c,d,e,f=this.numRows;for(c=0,d=a.rects.length;d>c;c++)e=a.rects[c],this.rects.push(new b(e.x,f+e.y,e.width,e.height));this.numRows+=a.numRows,this.numTiles+=a.numTiles},Tiles.Template.fromJSON=function(a){var b=c(a),e=d(b);return new Tiles.Template(e,b.length>0?b[0].length:0,b.length)},Tiles.Template.prototype.toJSON=function(){var a,b,c,d,e,f,g="ABCDEFGHIJKLMNOPQRSTUVWXYZ",h=g.length,i=0,j=[];for(e=0;e<this.numRows;e++)for(j[e]=[],d=0;d<this.numCols;d++)j[e][d]=Tiles.Template.SINGLE_CELL;for(a=0,b=this.rects.length;b>a;a++)if(c=this.rects[a],c.width>1||c.height>1){for(f=g[i],e=0;e<c.height;e++)for(d=0;d<c.width;d++)j[c.y+e][c.x+d]=f;i=(i+1)%h}for(e=0;e<this.numRows;e++)j[e]=j[e].join("");return j},Tiles.Template.SINGLE_CELL="."}(jQuery),Tiles.UniformTemplates={get:function(a,b){var c,d,e=Math.ceil(b/a),f=[];for(d=0;e>d;d++)for(c=0;a>c;c++)f.push(new Tiles.Rectangle(c,d,1,1));return new Tiles.Template(f,a,e)}},function(a){function b(b){var c,d,e=[],f=b?b.length:0;for(c=0;f>c;c++)d=b[c],-1===a.inArray(d,e)&&e.push(d);return e}function c(a,b,c){var d=a.y+a.height,e=a.x+a.width;return b&&!(b.top>d||b.top+b.height<a.y||b.left>e||b.left+b.width<a.x)?!0:c&&!(c.y>d||c.y+c.height<a.y||c.x>e||c.x+c.width<a.x)?!0:!1}var d=Tiles.Grid=function(b){this.$el=a(b),this.animationDuration=500,this.templateFactory=Tiles.UniformTemplates,this.priorityPageSize=Number.MAX_VALUE,this.cellPadding=10,this.cellWidthMin=150,this.cellHeightMin=150,this.cellWidth=0,this.cellHeight=0,this.cellAspectRatio=1,this.numCols=1,this.template=null,this.isDirty=!0,this.tiles=[],this.tilesAdded=[],this.tilesRemoved=[]};d.prototype.getContentWidth=function(){return this.$el.width()},d.prototype.resizeColumns=function(){var a=this.getContentWidth();return Math.max(1,Math.floor((a+this.cellPadding)/(this.cellWidthMin+this.cellPadding)))},d.prototype.resizeCellWidth=function(){var a=this.getContentWidth();return Math.ceil((a+this.cellPadding)/this.numCols)-this.cellPadding},d.prototype.resize=function(){var a=this.resizeColumns();this.numCols!==a&&a>0&&(this.numCols=a,this.isDirty=!0);var b=this.resizeCellWidth();this.cellWidth!==b&&b>0&&(this.cellWidth=b,this.cellHeight=this.cellWidth/this.cellAspectRatio,this.isDirty=!0)},d.prototype.updateTiles=function(c){c=b(c);var d,e,f,g,h=c.length,i=[];for(d=this.tiles.length-1;d>=0;d--)e=this.tiles[d],g=a.inArray(e.id,c),0>g?this.tilesRemoved.push(e):i[g]=e;for(this.tiles=[],d=0;h>d;d++){if(e=i[d],!e){if(f=c[d],this.createTile){if(e=this.createTile(f),!e)continue}else e=new Tiles.Tile(f);this.tilesAdded.push(e)}this.tiles.push(e)}},d.prototype.insertTiles=function(a){this.addTiles(a,!0)},d.prototype.addTiles=function(a,b){if(a&&0!==a.length){var c,d=[],e=this.tiles.length;for(c=0;e>c;c++)d.push(this.tiles[c].id);var f=b?a.concat(d):d.concat(a);this.updateTiles(f)}},d.prototype.removeTiles=function(b){if(b&&0!==b.length){var c,d,e,f=[];for(c=0,d=this.tiles.length;d>c;c++)e=this.tiles[c].id,-1===a.inArray(e,b)&&f.push(e);this.updateTiles(f)}},d.prototype.createTemplate=function(a,b){a=Math.max(1,a);var c=this.templateFactory.get(a,b);return c||(c=Tiles.UniformTemplates.get(a,b)),c},d.prototype.ensureTemplate=function(a){if(this.template&&this.template.numCols===this.numCols){var b=a-this.template.rects.length;b>0&&(this.template.append(this.createTemplate(this.numCols,b)),this.isDirty=!0)}else this.template=this.createTemplate(this.numCols,a),this.isDirty=!0},d.prototype.shouldRedraw=function(){this.cellWidth<=0&&this.resize(),this.ensureTemplate(this.tiles.length);var a=this.isDirty||this.tilesAdded.length>0||this.tilesRemoved.length>0;return a},d.prototype.getPixelRectangle=function(a){var b=this.cellWidth+this.cellPadding,c=this.cellHeight+this.cellPadding;return new Tiles.Rectangle(a.x*b,a.y*c,a.width*b-this.cellPadding,a.height*c-this.cellPadding)},d.prototype.redraw=function(b,d){if(!this.shouldRedraw())return void(d&&d(!1));var e,f,g,h,i,j,k,l,m,n,o,p=this.tiles.length,q=this.priorityPageSize,r=this.animationDuration,s=0,t=0,u=0,v=new Tiles.Rectangle(this.$el.scrollLeft(),this.$el.scrollTop(),this.$el.width(),this.$el.height());for(s=0;p>s;s+=q)for(g=this.template.rects.slice(s,s+q),h=this.tiles.slice(s,s+q),n=g.slice(0),o=h.slice(0),this.prioritizePage&&this.prioritizePage(n,o),i=0,j=o.length;j>i;i++)e=o[i],f=a.inArray(e,this.tilesAdded)>=0,k=n[i],l=this.getPixelRectangle(k),e.resize(k,l,b&&!f&&c(v,e,l),r),f&&(m=b&&c(v,null,l),m&&this.getAppendDelay?(t=this.getAppendDelay(k,g,n,e,h,o),u=Math.max(u,t)||0):t=0,e.appendTo(this.$el,m,t,r));for(i=0,j=this.tilesRemoved.length;j>i;i++)e=this.tilesRemoved[i],m=b&&c(v,e,null),e.remove(m,r);this.tilesRemoved=[],this.tilesAdded=[],this.isDirty=!1,d&&setTimeout(function(){d(!0)},Math.max(u,r)+10)}}(jQuery);